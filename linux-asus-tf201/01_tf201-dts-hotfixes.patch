From 7c6ba199f2f1b30bc76bd243df2b9d91b2fa0e6d Mon Sep 17 00:00:00 2001
From: Svyatoslav <clamor95@gmail.com>
Date: Thu, 4 Jun 2020 08:31:45 +0300
Subject: [PATCH] tf201-dts: fix build

And move more stuff to common.

Signed-off-by: Svyatoslav Ryhel <clamor95@gmail.com>
---
 arch/arm/boot/dts/tegra30-asus-tf201.dts      | 598 +++++++++---------
 .../dts/tegra30-asus-transformer-common.dtsi  |  73 ++-
 2 files changed, 354 insertions(+), 317 deletions(-)

diff --git a/arch/arm/boot/dts/tegra30-asus-tf201.dts b/arch/arm/boot/dts/tegra30-asus-tf201.dts
index 97784784c7ca..f13ff384ca56 100644
--- a/arch/arm/boot/dts/tegra30-asus-tf201.dts
+++ b/arch/arm/boot/dts/tegra30-asus-tf201.dts
@@ -73,28 +73,9 @@
 	};
 
 	uartc: serial@70006200 {
-		compatible = "nvidia,tegra30-hsuart";
-		status = "okay";
-
-		nvidia,adjust-baud-rates = <0 9600 100>,
-					   <9600 115200 200>,
-					   <1000000 4000000 136>;
-
 		/* Azurewave AW-NH615 BCM4329B1 */
 		bluetooth {
 			compatible = "brcm,bcm4329-bt";
-
-			max-speed = <4000000>;
-
-			clocks = <&tegra_pmc TEGRA_PMC_CLK_BLINK>;
-			clock-names = "txco";
-
-			vbat-supply  = <&vdd_3v3_sys>;
-			vddio-supply = <&vdd_1v8>;
-
-			device-wakeup-gpios = <&gpio TEGRA_GPIO(U, 1) GPIO_ACTIVE_HIGH>;	/* bt_ext_wake, out, lo	*/
-			host-wakeup-gpios =   <&gpio TEGRA_GPIO(U, 6) IRQ_TYPE_LEVEL_LOW>;	/* bt_host_wake, in, lo	*/
-			shutdown-gpios =      <&gpio TEGRA_GPIO(U, 0) GPIO_ACTIVE_LOW>;		/* bcm4329_nshutdown_gp, out, lo */
 		};
 	};
 
@@ -139,32 +120,21 @@
 		};
 
 		gyro@68 {
-			compatible = "invensense,mpu3050";
-			reg = <0x68>;
-			interrupt-parent = <&gpio>;
-			interrupts = <TEGRA_GPIO(X, 1) IRQ_TYPE_EDGE_RISING>;		// mpu3050, in, lo
-			mount-matrix = "0", "-1", "0", "-1", "0", "0", "0", "0", "-1";
-			accel-slave = <&accel>;
-			compass-slave = <&compass>;
+			mount-matrix =   "0", "-1",  "0",
+					"-1",  "0",  "0",
+					 "0",  "0", "-1";
 
 			i2c-gate {
-				#address-cells = <1>;
-				#size-cells = <0>;
-
 				accel: accel@f {
-					compatible = "kionix,kxtf9";
-					reg = <0x0f>;
-					interrupt-parent = <&gpio>;
-					interrupts = <TEGRA_GPIO(O, 5) IRQ_TYPE_EDGE_RISING>;	// kxtf9, in, lo
-					mount-matrix = "-1", "0", "0", "0", "1", "0", "0", "0", "-1";
+					mount-matrix =  "-1",  "0",  "0",
+							 "0",  "1",  "0",
+							 "0",  "0", "-1";
 				};
 
 				compass: compass@e {
-					compatible = "aichi,ami306";
-					reg = <0x0e>;
-					interrupt-parent = <&gpio>;
-					interrupts = <TEGRA_GPIO(W, 0) IRQ_TYPE_EDGE_RISING>;	// compassirq
-					mount-matrix = "-1", "0", "0", "0", "-1", "0", "0", "0", "-1";
+					mount-matrix =  "-1",  "0",  "0",
+							 "0", "-1",  "0",
+							 "0",  "0", "-1";
 				};
 			};
 		};
@@ -180,15 +150,11 @@
 		};
 	};
 
-	/* internal SDIO WiFi */
-	mmc@78000400 {		/* sdmmc3 */
+	/* internal SDIO WiFi sdmmc3 */
+	sdhci@78000400 {
 		/* Azurewave AW-NH615 BCM4329 */
 		wifi@1 {
-			reg = <1>;
 			compatible = "brcm,bcm4329-fmac";
-			interrupt-parent = <&gpio>;
-			interrupts = <TEGRA_GPIO(O, 4) IRQ_TYPE_LEVEL_HIGH>;	/* bcmsdh_sdmmc, in, lo */
-			interrupt-names = "host-wake";
 		};
 	};
 
@@ -204,6 +170,19 @@
 
 		data-mapping = "jeida-24";
 
+		panel-timing {
+			/* 1280x800@60Hz */
+			clock-frequency = <68000000>;
+			hactive = <1280>;
+			vactive = <800>;
+			hfront-porch = <48>;
+			hback-porch = <18>;
+			hsync-len = <30>;
+			vsync-len = <5>;
+			vfront-porch = <3>;
+			vback-porch = <12>;
+		};
+
 		port {
 			panel_input: endpoint {
 				remote-endpoint = <&lvds_encoder_output>;
@@ -279,6 +258,7 @@
 
 	memory-controller@7000f000 {
 		emc-timings-0 {
+			/* Elpida 1GB EDB8132B2MA-8D-F lpDDR2 */
 			nvidia,ram-code = <0>;
 
 			/* EMEM timings are common */
@@ -286,105 +266,105 @@
 				clock-frequency = <25500000>;
 
 				nvidia,emem-configuration = < 0x00020001 0x80000010
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000003 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000002 0x00000002
-						0x02020001 0x00060402 0x73e30303 0x001f0000 >;
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000003 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000002 0x00000002
+					0x02020001 0x00060402 0x73e30303 0x001f0000 >;
 			};
 
 			timing-51000000 {
 				clock-frequency = <51000000>;
 
 				nvidia,emem-configuration = < 0x00010001 0x80000010
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000003 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000002 0x00000002
-						0x02020001 0x00060402 0x72c30303 0x001f0000 >;
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000003 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000002 0x00000002
+					0x02020001 0x00060402 0x72c30303 0x001f0000 >;
 			};
 
 			timing-102000000 {
 				clock-frequency = <102000000>;
 
 				nvidia,emem-configuration = < 0x00000001 0x80000018
-						0x00000001 0x00000001 0x00000003 0x00000001
-						0x00000003 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000002 0x00000002
-						0x02020001 0x00060403 0x72430504 0x001f0000 >;
+					0x00000001 0x00000001 0x00000003 0x00000001
+					0x00000003 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000002 0x00000002
+					0x02020001 0x00060403 0x72430504 0x001f0000 >;
 			};
 
 			timing-204000000 {
 				clock-frequency = <204000000>;
 
 				nvidia,emem-configuration = < 0x00000003 0x80000025
-						0x00000001 0x00000001 0x00000006 0x00000003
-						0x00000005 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000003 0x00000002
-						0x02030001 0x00070506 0x71e40a07 0x001f0000 >;
+					0x00000001 0x00000001 0x00000006 0x00000003
+					0x00000005 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000003 0x00000002
+					0x02030001 0x00070506 0x71e40a07 0x001f0000 >;
 			};
 
 			timing-400000000 {
 				clock-frequency = <400000000>;
 
 				nvidia,emem-configuration = < 0x00000006 0x80000048
-						0x00000002 0x00000003 0x0000000c 0x00000007
-						0x00000009 0x00000001 0x00000002 0x00000006
-						0x00000001 0x00000000 0x00000004 0x00000004
-						0x04040001 0x000d090c 0x71c6120d 0x001f0000 >;
+					0x00000002 0x00000003 0x0000000c 0x00000007
+					0x00000009 0x00000001 0x00000002 0x00000006
+					0x00000001 0x00000000 0x00000004 0x00000004
+					0x04040001 0x000d090c 0x71c6120d 0x001f0000 >;
 			};
 		};
 
 		emc-timings-2 {
+			/* Unknown vendor lpDDR2 500MHz */
 			nvidia,ram-code = <2>;
 
-			/* EMEM timings are common */
 			timing-25500000 {
 				clock-frequency = <25500000>;
 
 				nvidia,emem-configuration = < 0x00020001 0x80000010
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000003 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000002 0x00000002
-						0x02020001 0x00060402 0x73e30303 0x001f0000 >;
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000003 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000002 0x00000002
+					0x02020001 0x00060402 0x73e30303 0x001f0000 >;
 			};
 
 			timing-51000000 {
 				clock-frequency = <51000000>;
 
 				nvidia,emem-configuration = < 0x00010001 0x80000010
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000003 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000002 0x00000002
-						0x02020001 0x00060402 0x72c30303 0x001f0000 >;
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000003 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000002 0x00000002
+					0x02020001 0x00060402 0x72c30303 0x001f0000 >;
 			};
 
 			timing-102000000 {
 				clock-frequency = <102000000>;
 
 				nvidia,emem-configuration = < 0x00000001 0x80000018
-						0x00000001 0x00000001 0x00000003 0x00000001
-						0x00000003 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000002 0x00000002
-						0x02020001 0x00060403 0x72430504 0x001f0000 >;
+					0x00000001 0x00000001 0x00000003 0x00000001
+					0x00000003 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000002 0x00000002
+					0x02020001 0x00060403 0x72430504 0x001f0000 >;
 			};
 
 			timing-204000000 {
 				clock-frequency = <204000000>;
 
 				nvidia,emem-configuration = < 0x00000003 0x80000025
-						0x00000001 0x00000001 0x00000006 0x00000003
-						0x00000005 0x00000001 0x00000002 0x00000004
-						0x00000001 0x00000000 0x00000003 0x00000002
-						0x02030001 0x00070506 0x71e40a07 0x001f0000 >;
+					0x00000001 0x00000001 0x00000006 0x00000003
+					0x00000005 0x00000001 0x00000002 0x00000004
+					0x00000001 0x00000000 0x00000003 0x00000002
+					0x02030001 0x00070506 0x71e40a07 0x001f0000 >;
 			};
 
 			timing-500000000 {
 				clock-frequency = <500000000>;
 
 				nvidia,emem-configuration = < 0x00000007 0x8000005a
-						0x00000003 0x00000004 0x0000000e 0x00000009
-						0x0000000c 0x00000002 0x00000002 0x00000008
-						0x00000001 0x00000000 0x00000004 0x00000005
-						0x05040001 0x00100a0e 0x71c8170f 0x001f0000 >;
+					0x00000003 0x00000004 0x0000000e 0x00000009
+					0x0000000c 0x00000002 0x00000002 0x00000008
+					0x00000001 0x00000000 0x00000004 0x00000005
+					0x05040001 0x00100a0e 0x71c8170f 0x001f0000 >;
 			};
 		};
 	};
@@ -405,29 +385,29 @@
 				nvidia,emc-cfg-dyn-self-ref;
 				nvidia,emc-cfg-periodic-qrst;
 
-				nvidia,emc-configuration =  < 0x00000001
-						0x00000003 0x00000002 0x00000002 0x00000004
-						0x00000004 0x00000001 0x00000005 0x00000002
-						0x00000002 0x00000001 0x00000001 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000b
-						0x0000000a 0x00000060 0x00000000 0x00000018
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000001 0x00000007 0x00000004 0x00000004
-						0x00000003 0x00000008 0x00000004 0x00000004
-						0x00000002 0x0000006b 0x00000004 0x00000004
-						0x00000000 0x00000000 0x00004282 0x00780084
-						0x00008000 0x00098000 0x00098000 0x00098000
-						0x00098000 0x00000010 0x00000010 0x00000010
-						0x00000010 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000008 0x00000008 0x00000008
-						0x00000008 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00080000 0x00080000 0x00080000
-						0x00080000 0x00100220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00000000
-						0x00000009 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x800001c5 0xe0000000 0xff00ff00 >;
+				nvidia,emc-configuration =  < 0x00000001 
+					0x00000003 0x00000002 0x00000002 0x00000004
+					0x00000004 0x00000001 0x00000005 0x00000002
+					0x00000002 0x00000001 0x00000001 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000b
+					0x0000000a 0x00000060 0x00000000 0x00000018
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000001 0x00000007 0x00000004 0x00000004
+					0x00000003 0x00000008 0x00000004 0x00000004
+					0x00000002 0x0000006b 0x00000004 0x00000004
+					0x00000000 0x00000000 0x00004282 0x00780084
+					0x00008000 0x00098000 0x00098000 0x00098000
+					0x00098000 0x00000010 0x00000010 0x00000010
+					0x00000010 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000008 0x00000008 0x00000008
+					0x00000008 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00080000 0x00080000 0x00080000
+					0x00080000 0x00100220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00000000
+					0x00000009 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x800001c5 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-51000000 {
@@ -442,28 +422,28 @@
 				nvidia,emc-cfg-periodic-qrst;
 
 				nvidia,emc-configuration =  < 0x00000003
-						0x00000006 0x00000002 0x00000002 0x00000004
-						0x00000004 0x00000001 0x00000005 0x00000002
-						0x00000002 0x00000001 0x00000001 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000b
-						0x0000000a 0x000000c0 0x00000000 0x00000030
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000001 0x00000007 0x00000008 0x00000008
-						0x00000003 0x00000008 0x00000004 0x00000004
-						0x00000002 0x000000d5 0x00000004 0x00000004
-						0x00000000 0x00000000 0x00004282 0x00780084
-						0x00008000 0x00098000 0x00098000 0x00098000
-						0x00098000 0x00000010 0x00000010 0x00000010
-						0x00000010 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000018 0x00000018 0x00000018
-						0x00000018 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00080000 0x00080000 0x00080000
-						0x00080000 0x00100220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00000000
-						0x00000009 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x80000287 0xe0000000 0xff00ff00 >;
+					0x00000006 0x00000002 0x00000002 0x00000004
+					0x00000004 0x00000001 0x00000005 0x00000002
+					0x00000002 0x00000001 0x00000001 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000b
+					0x0000000a 0x000000c0 0x00000000 0x00000030
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000001 0x00000007 0x00000008 0x00000008
+					0x00000003 0x00000008 0x00000004 0x00000004
+					0x00000002 0x000000d5 0x00000004 0x00000004
+					0x00000000 0x00000000 0x00004282 0x00780084
+					0x00008000 0x00098000 0x00098000 0x00098000
+					0x00098000 0x00000010 0x00000010 0x00000010
+					0x00000010 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000018 0x00000018 0x00000018
+					0x00000018 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00080000 0x00080000 0x00080000
+					0x00080000 0x00100220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00000000
+					0x00000009 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x80000287 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-102000000 {
@@ -478,28 +458,28 @@
 				nvidia,emc-cfg-periodic-qrst;
 
 				nvidia,emc-configuration =  < 0x00000006
-						0x0000000d 0x00000004 0x00000002 0x00000004
-						0x00000004 0x00000001 0x00000005 0x00000002
-						0x00000002 0x00000001 0x00000001 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000b
-						0x0000000a 0x00000181 0x00000000 0x00000060
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000001 0x00000007 0x0000000f 0x0000000f
-						0x00000003 0x00000008 0x00000004 0x00000004
-						0x00000002 0x000001a9 0x00000004 0x00000006
-						0x00000000 0x00000000 0x00004282 0x00780084
-						0x00008000 0x000a0000 0x000a0000 0x000a0000
-						0x000a0000 0x00000010 0x00000010 0x00000010
-						0x00000010 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000008 0x00000008 0x00000008
-						0x00000008 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00080000 0x00080000 0x00080000
-						0x00080000 0x00120220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00000000
-						0x0000000a 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x8000040b 0xe0000000 0xff00ff00 >;
+					0x0000000d 0x00000004 0x00000002 0x00000004
+					0x00000004 0x00000001 0x00000005 0x00000002
+					0x00000002 0x00000001 0x00000001 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000b
+					0x0000000a 0x00000181 0x00000000 0x00000060
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000001 0x00000007 0x0000000f 0x0000000f
+					0x00000003 0x00000008 0x00000004 0x00000004
+					0x00000002 0x000001a9 0x00000004 0x00000006
+					0x00000000 0x00000000 0x00004282 0x00780084
+					0x00008000 0x000a0000 0x000a0000 0x000a0000
+					0x000a0000 0x00000010 0x00000010 0x00000010
+					0x00000010 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000008 0x00000008 0x00000008
+					0x00000008 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00080000 0x00080000 0x00080000
+					0x00080000 0x00120220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00000000
+					0x0000000a 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x8000040b 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-204000000 {
@@ -514,28 +494,28 @@
 				nvidia,emc-cfg-periodic-qrst;
 
 				nvidia,emc-configuration =  < 0x0000000c
-						0x0000001a 0x00000008 0x00000003 0x00000005
-						0x00000004 0x00000001 0x00000006 0x00000003
-						0x00000003 0x00000002 0x00000002 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000c
-						0x0000000a 0x00000303 0x00000000 0x000000c0
-						0x00000001 0x00000001 0x00000003 0x00000000
-						0x00000001 0x00000007 0x0000001d 0x0000001d
-						0x00000004 0x0000000b 0x00000005 0x00000004
-						0x00000002 0x00000351 0x00000004 0x00000006
-						0x00000000 0x00000000 0x00004282 0x00440084
-						0x00008000 0x00074000 0x00074000 0x00074000
-						0x00074000 0x00000010 0x00000010 0x00000010
-						0x00000010 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000018 0x00000018 0x00000018
-						0x00000018 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00078000 0x00078000 0x00078000
-						0x00078000 0x00100220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00000000
-						0x00000013 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x80000713 0xe0000000 0xff00ff00 >;
+					0x0000001a 0x00000008 0x00000003 0x00000005
+					0x00000004 0x00000001 0x00000006 0x00000003
+					0x00000003 0x00000002 0x00000002 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000c
+					0x0000000a 0x00000303 0x00000000 0x000000c0
+					0x00000001 0x00000001 0x00000003 0x00000000
+					0x00000001 0x00000007 0x0000001d 0x0000001d
+					0x00000004 0x0000000b 0x00000005 0x00000004
+					0x00000002 0x00000351 0x00000004 0x00000006
+					0x00000000 0x00000000 0x00004282 0x00440084
+					0x00008000 0x00074000 0x00074000 0x00074000
+					0x00074000 0x00000010 0x00000010 0x00000010
+					0x00000010 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000018 0x00000018 0x00000018
+					0x00000018 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00078000 0x00078000 0x00078000
+					0x00078000 0x00100220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00000000
+					0x00000013 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x80000713 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-400000000 {
@@ -548,28 +528,28 @@
 				nvidia,emc-zcal-cnt-long = <0x00000024>;
 
 				nvidia,emc-configuration =  < 0x00000017
-						0x00000033 0x00000010 0x00000007 0x00000007
-						0x00000007 0x00000002 0x0000000a 0x00000007
-						0x00000007 0x00000003 0x00000002 0x00000000
-						0x00000003 0x00000007 0x00000004 0x0000000d
-						0x0000000e 0x000005e9 0x00000000 0x0000017a
-						0x00000002 0x00000002 0x00000007 0x00000000
-						0x00000001 0x0000000c 0x00000038 0x00000038
-						0x00000006 0x00000014 0x00000009 0x00000004
-						0x00000002 0x00000680 0x00000000 0x00000006
-						0x00000000 0x00000000 0x00006282 0x001d0084
-						0x00008000 0x0002c000 0x0002c000 0x0002c000
-						0x0002c000 0x00000010 0x00000010 0x00000010
-						0x00000010 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000008 0x00000008 0x00000008
-						0x00000008 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00048000 0x00048000 0x00048000
-						0x00048000 0x000c0220 0x0800003d 0x00000000
-						0x77ffc004 0x01f1f408 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00000000
-						0x00000024 0x000c000c 0xa0f10000 0x00000000
-						0x00000000 0x80000ce6 0xe0000000 0xff00ff88 >;
+					0x00000033 0x00000010 0x00000007 0x00000007
+					0x00000007 0x00000002 0x0000000a 0x00000007
+					0x00000007 0x00000003 0x00000002 0x00000000
+					0x00000003 0x00000007 0x00000004 0x0000000d
+					0x0000000e 0x000005e9 0x00000000 0x0000017a
+					0x00000002 0x00000002 0x00000007 0x00000000
+					0x00000001 0x0000000c 0x00000038 0x00000038
+					0x00000006 0x00000014 0x00000009 0x00000004
+					0x00000002 0x00000680 0x00000000 0x00000006
+					0x00000000 0x00000000 0x00006282 0x001d0084
+					0x00008000 0x0002c000 0x0002c000 0x0002c000
+					0x0002c000 0x00000010 0x00000010 0x00000010
+					0x00000010 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000008 0x00000008 0x00000008
+					0x00000008 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00048000 0x00048000 0x00048000
+					0x00048000 0x000c0220 0x0800003d 0x00000000
+					0x77ffc004 0x01f1f408 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00000000
+					0x00000024 0x000c000c 0xa0f10000 0x00000000
+					0x00000000 0x80000ce6 0xe0000000 0xff00ff88 >;
 			};
 		};
 
@@ -588,29 +568,29 @@
 				nvidia,emc-cfg-dyn-self-ref;
 				nvidia,emc-cfg-periodic-qrst;
 
-				nvidia,emc-configuration =  < 0x00000001
-						0x00000003 0x00000002 0x00000002 0x00000004
-						0x00000004 0x00000001 0x00000005 0x00000002
-						0x00000002 0x00000001 0x00000001 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000b
-						0x00000009 0x00000060 0x00000000 0x00000018
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000001 0x00000007 0x00000004 0x00000004
-						0x00000003 0x00000008 0x00000004 0x00000004
-						0x00000002 0x0000006b 0x00000004 0x00000004
-						0x00000000 0x00000000 0x00004282 0x00780084
-						0x00008000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x00100220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00064000
-						0x0000000a 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x800001c5 0xe0000000 0xff00ff00 >;
+				nvidia,emc-configuration =  < 0x00000001 
+					0x00000003 0x00000002 0x00000002 0x00000004
+					0x00000004 0x00000001 0x00000005 0x00000002
+					0x00000002 0x00000001 0x00000001 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000b
+					0x00000009 0x00000060 0x00000000 0x00000018
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000001 0x00000007 0x00000004 0x00000004
+					0x00000003 0x00000008 0x00000004 0x00000004
+					0x00000002 0x0000006b 0x00000004 0x00000004
+					0x00000000 0x00000000 0x00004282 0x00780084
+					0x00008000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x00100220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00064000
+					0x0000000a 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x800001c5 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-51000000 {
@@ -625,28 +605,28 @@
 				nvidia,emc-cfg-periodic-qrst;
 
 				nvidia,emc-configuration =  < 0x00000003
-						0x00000006 0x00000002 0x00000002 0x00000004
-						0x00000004 0x00000001 0x00000005 0x00000002
-						0x00000002 0x00000001 0x00000001 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000b
-						0x00000009 0x000000c0 0x00000000 0x00000030
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000001 0x00000007 0x00000008 0x00000008
-						0x00000003 0x00000008 0x00000004 0x00000004
-						0x00000002 0x000000d5 0x00000004 0x00000004
-						0x00000000 0x00000000 0x00004282 0x00780084
-						0x00008000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x00100220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00064000
-						0x00000013 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x80000287 0xe0000000 0xff00ff00 >;
+					0x00000006 0x00000002 0x00000002 0x00000004
+					0x00000004 0x00000001 0x00000005 0x00000002
+					0x00000002 0x00000001 0x00000001 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000b
+					0x00000009 0x000000c0 0x00000000 0x00000030
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000001 0x00000007 0x00000008 0x00000008
+					0x00000003 0x00000008 0x00000004 0x00000004
+					0x00000002 0x000000d5 0x00000004 0x00000004
+					0x00000000 0x00000000 0x00004282 0x00780084
+					0x00008000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x00100220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00064000
+					0x00000013 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x80000287 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-102000000 {
@@ -661,28 +641,28 @@
 				nvidia,emc-cfg-periodic-qrst;
 
 				nvidia,emc-configuration =  < 0x00000006
-						0x0000000d 0x00000004 0x00000002 0x00000004
-						0x00000004 0x00000001 0x00000005 0x00000002
-						0x00000002 0x00000001 0x00000001 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000b
-						0x00000009 0x00000181 0x00000000 0x00000060
-						0x00000001 0x00000001 0x00000002 0x00000000
-						0x00000001 0x00000007 0x0000000f 0x0000000f
-						0x00000003 0x00000008 0x00000004 0x00000004
-						0x00000002 0x000001a9 0x00000004 0x00000004
-						0x00000000 0x00000000 0x00004282 0x00780084
-						0x00008000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x000fc000 0x000fc000 0x000fc000
-						0x000fc000 0x00100220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00064000
-						0x00000025 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x8000040b 0xe0000000 0xff00ff00 >;
+					0x0000000d 0x00000004 0x00000002 0x00000004
+					0x00000004 0x00000001 0x00000005 0x00000002
+					0x00000002 0x00000001 0x00000001 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000b
+					0x00000009 0x00000181 0x00000000 0x00000060
+					0x00000001 0x00000001 0x00000002 0x00000000
+					0x00000001 0x00000007 0x0000000f 0x0000000f
+					0x00000003 0x00000008 0x00000004 0x00000004
+					0x00000002 0x000001a9 0x00000004 0x00000004
+					0x00000000 0x00000000 0x00004282 0x00780084
+					0x00008000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x000fc000 0x000fc000 0x000fc000
+					0x000fc000 0x00100220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00064000
+					0x00000025 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x8000040b 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-204000000 {
@@ -697,28 +677,28 @@
 				nvidia,emc-cfg-periodic-qrst;
 
 				nvidia,emc-configuration =  < 0x0000000c
-						0x0000001a 0x00000008 0x00000003 0x00000005
-						0x00000004 0x00000001 0x00000006 0x00000003
-						0x00000003 0x00000002 0x00000002 0x00000000
-						0x00000001 0x00000003 0x00000001 0x0000000c
-						0x0000000a 0x00000303 0x00000000 0x000000c0
-						0x00000001 0x00000001 0x00000003 0x00000000
-						0x00000001 0x00000007 0x0000001d 0x0000001d
-						0x00000004 0x0000000b 0x00000005 0x00000004
-						0x00000002 0x00000351 0x00000004 0x00000006
-						0x00000000 0x00000000 0x00004282 0x00440084
-						0x00008000 0x00060000 0x00060000 0x00060000
-						0x00060000 0x00072000 0x00072000 0x00072000
-						0x00072000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x000d0000 0x000d0000 0x000d0000
-						0x000d0000 0x000e0220 0x0800201c 0x00000000
-						0x77ffc004 0x01f1f008 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00064000
-						0x0000004a 0x00090009 0xa0f10000 0x00000000
-						0x00000000 0x80000713 0xe0000000 0xff00ff00 >;
+					0x0000001a 0x00000008 0x00000003 0x00000005
+					0x00000004 0x00000001 0x00000006 0x00000003
+					0x00000003 0x00000002 0x00000002 0x00000000
+					0x00000001 0x00000003 0x00000001 0x0000000c
+					0x0000000a 0x00000303 0x00000000 0x000000c0
+					0x00000001 0x00000001 0x00000003 0x00000000
+					0x00000001 0x00000007 0x0000001d 0x0000001d
+					0x00000004 0x0000000b 0x00000005 0x00000004
+					0x00000002 0x00000351 0x00000004 0x00000006
+					0x00000000 0x00000000 0x00004282 0x00440084
+					0x00008000 0x00060000 0x00060000 0x00060000
+					0x00060000 0x00072000 0x00072000 0x00072000
+					0x00072000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x000d0000 0x000d0000 0x000d0000
+					0x000d0000 0x000e0220 0x0800201c 0x00000000
+					0x77ffc004 0x01f1f008 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00064000
+					0x0000004a 0x00090009 0xa0f10000 0x00000000
+					0x00000000 0x80000713 0xe0000000 0xff00ff00 >;
 			};
 
 			timing-500000000 {
@@ -732,29 +712,29 @@
 				nvidia,emc-cfg-dyn-self-ref;
 				nvidia,emc-cfg-periodic-qrst;
 
-				nvidia,emc-configuration =  < 0x0000001d
-						0x00000040 0x00000014 0x00000008 0x00000007
-						0x00000009 0x00000003 0x0000000d 0x00000008
-						0x00000008 0x00000004 0x00000002 0x00000000
-						0x00000004 0x00000008 0x00000005 0x0000000d
-						0x0000000f 0x00000763 0x00000000 0x000001d8
-						0x00000003 0x00000003 0x00000008 0x00000000
-						0x00000001 0x0000000e 0x00000046 0x00000046
-						0x00000008 0x00000019 0x0000000b 0x00000004
-						0x00000002 0x00000820 0x00000000 0x00000006
-						0x00000000 0x00000000 0x00006282 0xf0140091
-						0x00008000 0x00000008 0x00000008 0x00000008
-						0x00000008 0x0000000a 0x0000000a 0x0000000a
-						0x0000000a 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x00000000 0x00000000 0x00000000
-						0x00000000 0x0000000c 0x0000000c 0x0000000c
-						0x0000000c 0x00080220 0x0800003d 0x00000000
-						0x77ffc004 0x01f1f408 0x00000000 0x00000007
-						0x08000068 0x08000000 0x00000802 0x00064000
-						0x000000b4 0x000d000d 0xa0f10404 0x00000000
-						0x00000000 0x80000fde 0xe0000000 0xff00ff88 >;
+				nvidia,emc-configuration =  < 0x0000001d 
+					0x00000040 0x00000014 0x00000008 0x00000007
+					0x00000009 0x00000003 0x0000000d 0x00000008
+					0x00000008 0x00000004 0x00000002 0x00000000
+					0x00000004 0x00000008 0x00000005 0x0000000d
+					0x0000000f 0x00000763 0x00000000 0x000001d8
+					0x00000003 0x00000003 0x00000008 0x00000000
+					0x00000001 0x0000000e 0x00000046 0x00000046
+					0x00000008 0x00000019 0x0000000b 0x00000004
+					0x00000002 0x00000820 0x00000000 0x00000006
+					0x00000000 0x00000000 0x00006282 0xf0140091
+					0x00008000 0x00000008 0x00000008 0x00000008
+					0x00000008 0x0000000a 0x0000000a 0x0000000a
+					0x0000000a 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x00000000 0x00000000 0x00000000
+					0x00000000 0x0000000c 0x0000000c 0x0000000c
+					0x0000000c 0x00080220 0x0800003d 0x00000000
+					0x77ffc004 0x01f1f408 0x00000000 0x00000007
+					0x08000068 0x08000000 0x00000802 0x00064000
+					0x000000b4 0x000d000d 0xa0f10404 0x00000000
+					0x00000000 0x80000fde 0xe0000000 0xff00ff88 >;
 			};
 		};
 	};
diff --git a/arch/arm/boot/dts/tegra30-asus-transformer-common.dtsi b/arch/arm/boot/dts/tegra30-asus-transformer-common.dtsi
index 17a890bbd0b8..054b538cc95d 100644
--- a/arch/arm/boot/dts/tegra30-asus-transformer-common.dtsi
+++ b/arch/arm/boot/dts/tegra30-asus-transformer-common.dtsi
@@ -65,7 +65,7 @@
 		};
 
 		trustzone@bfe00000 {
-			// used by TF firmware
+			/* used by TF firmware */
 			reg = <0xbfe00000 0x200000>;	/* 2MB */
 			no-map;
 		};
@@ -226,7 +226,7 @@
 				nvidia,tristate = <TEGRA_PIN_DISABLE>;
 				nvidia,enable-input = <TEGRA_PIN_ENABLE>;
 				nvidia,open-drain = <TEGRA_PIN_ENABLE>;
-			};
+			};	
 
 			/* HDMI-CEC  pinmux */
 			hdmi_cec_pee3 {
@@ -857,6 +857,29 @@
 		};
 	};
 
+	uartc: serial@70006200 {
+		compatible = "nvidia,tegra30-hsuart";
+		status = "okay";
+
+		nvidia,adjust-baud-rates = <0 9600 100>,
+					   <9600 115200 200>,
+					   <1000000 4000000 136>;
+
+		bluetooth {
+			max-speed = <4000000>;
+
+			clocks = <&tegra_pmc TEGRA_PMC_CLK_BLINK>;
+			clock-names = "txco";
+
+			vbat-supply  = <&vdd_3v3_sys>;
+			vddio-supply = <&vdd_1v8>;
+
+			device-wakeup-gpios = <&gpio TEGRA_GPIO(U, 1) GPIO_ACTIVE_HIGH>;	/* bt_ext_wake, out, lo	*/
+			host-wakeup-gpios =   <&gpio TEGRA_GPIO(U, 6) GPIO_ACTIVE_HIGH>;	/* bt_host_wake, in, lo	*/
+			shutdown-gpios =      <&gpio TEGRA_GPIO(U, 0) GPIO_ACTIVE_HIGH>;	/* bcm43xx_nshutdown_gp, out, lo */
+		};
+	};
+
 	pwm@7000a000 {
 		status = "okay";
 	};
@@ -945,6 +968,34 @@
 
 			vdd-supply = <&vdd_3v3_sys>;
 		};
+
+		gyro@68 {
+			compatible = "invensense,mpu3050";
+			reg = <0x68>;
+			interrupt-parent = <&gpio>;
+			interrupts = <TEGRA_GPIO(X, 1) IRQ_TYPE_EDGE_RISING>;		// mpu3050, in, lo
+			accel-slave = <&accel>;
+			compass-slave = <&compass>;
+
+			i2c-gate {
+				#address-cells = <1>;
+				#size-cells = <0>;
+
+				accel: accel@f {
+					compatible = "kionix,kxtf9";
+					reg = <0x0f>;
+					interrupt-parent = <&gpio>;
+					interrupts = <TEGRA_GPIO(O, 5) IRQ_TYPE_EDGE_RISING>;	// kxtf9, in, lo
+				};
+
+				compass: compass@e {
+					compatible = "aichi,ami306";
+					reg = <0x0e>;
+					interrupt-parent = <&gpio>;
+					interrupts = <TEGRA_GPIO(W, 0) IRQ_TYPE_EDGE_RISING>;	// compassirq
+				};
+			};
+		};
 	};
 
 	hdmi_ddc: i2c@7000c700 {		/*i2c4*/
@@ -1232,7 +1283,12 @@
 		vmmc-supply = <&vdd_3v3_sys>;
 		vqmmc-supply = <&vdd_1v8>;
 
-		/* WIFI setup is in dts */
+		wifi@1 {
+			reg = <1>;
+			interrupt-parent = <&gpio>;
+			interrupts = <TEGRA_GPIO(O, 4) IRQ_TYPE_LEVEL_HIGH>;	/* bcmsdh_sdmmc, in, lo */
+			interrupt-names = "host-wake";
+		};
 	};
 
 	/* internal eMMC */
@@ -1261,7 +1317,7 @@
 
 	/* Dock's USB port */
 	usb@7d008000 {			/* usb3 */
-		status = "okay";
+		status = "okay";		
 	};
 
 	usb-phy@7d008000 {		/* phy3 */
@@ -1275,8 +1331,9 @@
 		power-supply = <&vdd_5v0_sys>;
 		pwms = <&pwm 0 5000000>;
 
-		brightness-levels = <2 4 8 16 32 64 128 255>;
-		default-brightness-level = <6>;
+		brightness-levels = <1 255>;
+		num-interpolated-steps = <254>;
+		default-brightness-level = <15>;
 	};
 
 	clocks {
@@ -1284,14 +1341,14 @@
 		#address-cells = <1>;
 		#size-cells = <0>;
 
+		/* PMIC has a built-in 32KHz oscillator which is used by PMC */
 		clk32k_in: clock@0 {
 			compatible = "fixed-clock";
 			reg = <0>;
 			#clock-cells = <0>;
 			clock-frequency = <32768>;
+			clock-output-names = "pmic-oscillator";
 		};
-
-		// TODO: clk_out2 <- clk_m [26 MHz]
 	};
 
 	cpus {
